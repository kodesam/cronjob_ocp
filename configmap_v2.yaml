apiVersion: v1
kind: ConfigMap
metadata:
  name: hcconfigmap-v2
data:
  check_status.sh: |
    #!/bin/sh

    current_date=$(date +"%Y-%m-%d")
    filename_prefix="status_check_output"
    output_log="${filename_prefix}_${current_date}.log"

    (
        echo $current_date
        
        #get nodes status
       
        echo "checking node status" 
        echo "#############################################################################################################" 
        echo "#############################################################################################################" 
        oc get nodes

        #get clusteroperator status
        echo "#############################################################################################################" 
        echo "#############################################################################################################" 
        oc get co 

        #get pods status
      
        echo "checking pods status" 
        echo "#############################################################################################################" 
        echo "#############################################################################################################" 
        oc get pods -A | egrep -v 'Running|Completed'

        #get top node cpu and memory
      
        echo "checking node top memory and util" 
        echo "#############################################################################################################" 
        echo "#############################################################################################################" 
        oc adm top node

        #get top pod cpu and memory
        
        echo "checking top pods cpu and memory util"
        echo "#############################################################################################################" 
        echo "#############################################################################################################" 
        oc adm top pod -A
    ) 
